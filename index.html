<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>GW-BASIC Virtual Keyboard Styled</title>
<link rel="stylesheet" href="jsdos/js-dos.css">
<style>
  body, html { margin:0; height:100%; background:#000; display:flex; flex-direction:column; }
  #dosbox { flex:1; width:100%; height:100%; display:block; }
  #keyboard { background:#222; padding:10px; display:grid; grid-template-columns: repeat(14, 1fr); gap:4px; }
  .key { background:#444; color:#fff; border:none; border-radius:4px; padding:8px; font-size:14px; cursor:pointer; }
  .key:active, .key.active { background:#888; }
  .wide { grid-column: span 2; }
  .space { grid-column: span 5; }
</style>
</head>
<body>
<canvas id="dosbox"></canvas>
<div id="keyboard"></div>

<script src="jsdos/js-dos.js"></script>
<script>
const canvas = document.getElementById("dosbox");

Dos(canvas, { wdosboxUrl: "jsdos/wdosbox.js" })
.ready((fs, main) => {
    fs.extract("basic.zip").then(() => {
        main(["-c", "mount c .", "-c", "c:", "-c", "cd gwbasic", "-c", "gwbasic"])
        .then((ci) => {

            // Attach the built-in virtual keyboard (functionality)
            DosController.Qwerty(ci.getParentDiv(), ci.getKeyEventConsumer());

            // Optional: custom styled keyboard
            const layout = [
              ["Esc","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","-","=","Backspace"],
              ["Tab","1","2","3","4","5","6","7","8","9","0","-","=","Enter"],
              ["Caps","Q","W","E","R","T","Y","U","I","O","P","[","]","\\",""],
              ["Shift","A","S","D","F","G","H","J","K","L",";","'","","Shift",""],
              ["Z","X","C","V","B","N","M",",",".","/","","","","",""],
              ["Ctrl","Alt","Space","Alt","Ctrl","","","","","","","","",""]
            ];

            const kb = document.getElementById("keyboard");

            // Build buttons
            layout.forEach(row => {
              row.forEach(k => {
                if(k === "") { kb.appendChild(document.createElement("div")); return; }
                const btn = document.createElement("button");
                btn.className = "key";
                btn.textContent = k;
                if(k==="Backspace"||k==="Enter") btn.classList.add("wide");
                if(k==="Space") btn.classList.add("space");

                // Send key to JS-DOS using the same consumer as Qwerty
                btn.addEventListener("click", () => {
                    const consumer = ci.getKeyEventConsumer();
                    consumer(k); // forwards key to DOSBox
                });

                kb.appendChild(btn);
              });
            });
        });
    });
});
</script>
</body>
</html>
